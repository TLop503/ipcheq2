{{ define "history" }}
{{ if . }}
{{ range . }}
<div id="result-container">
  <h3>IP: {{ .IP }}</h3>
  <ul>
    <li>ISP: {{ .ISP }}</li>
    <li>Domain: {{ .Domain }}</li>
    <li>Country: {{ .Country }} ({{ .CountryCode }})</li>
    <li>Usage Type: {{ .UsageType }}</li>
    <li>VPN Status: {{ .ParsedRes }}
    </li>
    <li>Total Reports: {{ .TotalReports }}</li>
    <ul><li>Last Reported: {{ .LastReported }}</li></ul>
    <li>Abuse Confidence: {{ .AbuseConfidence }}%</li>
    {{ if .AbuseLinks }}
    <ul>
      <li><a href="https://www.abuseipdb.com/check/{{ .IP }}" target="_blank">Abuse IPDB Details</a></li>
      <li><a href="https://otx.alienvault.com/indicator/ip/{{ .IP }}" target="_blank">OTX Indicator Page</a></li>
    </ul>
    {{ end }}
    <li>Risk Level: {{ .ThreatRisk }}</li>
    <li>Number of Distinct Users: {{ .Users }}</li>
  </ul>
</div>
<hr>
{{ end }}
{{ else }}
<p>No IP queries in history yet.</p>
<hr>
{{ end }}
{{ end }}